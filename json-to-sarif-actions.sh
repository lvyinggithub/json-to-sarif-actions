#!/bin/bash
#name=$1
json_file_path=$1
licens_sarif_path=$2

head=""

#json_file_path=$(cat license-go.json | sed 's/[[:space:]]//g' | sed 's/"/\\"/g' ) 

json_str=$(cat ${json_file_path} | sed 's/[[:space:]]//g' | sed 's/"/\\"/g' ) 
echo -e $json_str

#head='"{\n  \"$schema\": \"https://schemastore.azurewebsites.net/schemas/json/sarif-2.1.0-rtm.4.json\",\n  \"version\": \"2.1.0\",\n  \"runs\": [\n    {\n      \"tool\": {\n        \"driver\": {\n          \"name\": \"dep-scan\",\n          \"fullName\": \"dep-scan-tools\",\n          \"version\": \"0.0.0\",\n          \"semanticVersion\": \"0.0.0\",\n          \"dottedQuadFileVersion\": \"0.0.0.0\",\n          \"rules\": [\n            {\n              \"id\": \"dep-scan-1\",\n              \"shortDescription\": {\n                \"text\": \"dep-san title\"\n              },\n              \"fullDescription\": {\n                \"text\": \"dep-san full description\"\n              },\n              \"help\": {\n\n                \"text\": \"dep-scan-results\nPackage: Package-string\nVersion: Version-string\nLicense Id: License Id string\nLicense conditions: License conditions string\n\",\n                \"markdown\": \"**dep-scan-results**\n| Package | Version | License Id | License conditions | \n| --- | --- | --- | --- | \n|Package-string|Version-string|License Id string|License conditions string|\n\"\n              }\n            }\n          ]\n        }\n      },\n      \"logicalLocations\": [\n        {\n          \"name\": \"dockerfile\",\n          \"fullyQualifiedName\": \"dockerfile\",\n          \"kind\": \"namespace\"\n        }\n      ],\n      \"results\": [\n        {\n          \"ruleId\": \"dep-scan-1\",\n          \"ruleIndex\": 0,\n          \"level\": \"error\",\n          \"message\": {\n            \"text\": \"xx.sarif\",\n            \"id\": \"default\"\n          },\n          \"analysisTarget\": {\n            \"uri\": \"xx.sarif\"\n          },\n          \"locations\": [\n            {\n              \"physicalLocation\": {\n                \"artifactLocation\": {\n                  \"uri\": \"xx.sarif\"\n                },\n                \"region\": {\n                  \"startLine\": 1,\n                  \"startColumn\": 1,\n                  \"endLine\": 1,\n                  \"endColumn\": 1,\n                  \"byteOffset\": 1,\n                  \"byteLength\": 1\n                }\n              },\n              \"logicalLocations\": [\n                {\n                  \"fullyQualifiedName\": \"dockerfile\"\n                }\n              ]\n            }\n          ],\n          \"suppressions\": [\n            {\n              \"kind\": \"external\"\n            }\n          ],\n          \"baselineState\": \"unchanged\"\n        },\n        {\n          \"ruleId\": \"dep-scan-1\",\n          \"ruleIndex\": 0,\n          \"level\": \"error\",\n          \"message\": {\n            \"text\": \"The path xx.sarif \",\n            \"id\": \"default\"\n          },\n          \"analysisTarget\": {\n            \"uri\": \"xx.sarif\"\n          },\n          \"locations\": [\n            {\n              \"physicalLocation\": {\n                \"artifactLocation\": {\n                  \"uri\": \"xx.sarif\"\n                },\n                \"region\": {\n                  \"startLine\": 1,\n                  \"startColumn\": 1,\n                  \"endLine\": 1,\n                  \"endColumn\": 1,\n                  \"byteOffset\": 1,\n                  \"byteLength\": 1\n                }\n              },\n              \"logicalLocations\": [\n                {\n                  \"fullyQualifiedName\": \"dockerfile\"\n                }\n              ]\n            }\n          ],\n          \"suppressions\": [\n            {\n              \"kind\": \"external\"\n            }\n          ],\n          \"baselineState\": \"unchanged\"\n        }\n      ],\n      \"columnKind\": \"utf16CodeUnits\"\n    }\n  ]\n}"'
head='"{\n  \"$schema\": \"https://schemastore.azurewebsites.net/schemas/json/sarif-2.1.0-rtm.4.json\",\n  \"version\": \"2.1.0\",\n  \"runs\": [\n    {\n      \"tool\": {\n        \"driver\": {\n          \"name\": \"dep-scan\",\n          \"fullName\": \"dep-scan-tools\",\n          \"version\": \"0.0.0\",\n          \"semanticVersion\": \"0.0.0\",\n          \"dottedQuadFileVersion\": \"0.0.0.0\",\n          \"rules\": [\n            {\n              \"id\": \"dep-scan-1\",\n              \"shortDescription\": {\n                \"text\": \"dep-san title\"\n              },\n              \"fullDescription\": {\n                \"text\": \"dep-san full description\"\n              },\n              \"help\": {\n\n                \"text\": \"dep-scan-results\nPackage: Package-string\nVersion: Version-string\nLicense Id: License Id string\nLicense conditions: License conditions string\n\",\n                \"markdown\": \"**dep-scan-results**\n| Package | Version | License Id | License conditions | \n| --- | --- | --- | --- | \n|Package-string|Version-string|License Id string|License conditions string|\n\"\n              }\n            }\n          ]\n        }\n      },\n      \"logicalLocations\": [\n        {\n          \"name\": \"dockerfile\",\n          \"fullyQualifiedName\": \"dockerfile\",\n          \"kind\": \"namespace\"\n        }\n      ],\n      \"results\": [\n        {\n          \"ruleId\": \"dep-scan-1\",\n          \"ruleIndex\": 0,\n          \"level\": \"error\",\n          \"message\": {\n            \"text\": \"xx.sarif\",\n            \"id\": \"default\"\n          },\n          \"analysisTarget\": {\n            \"uri\": \"xx.sarif\"\n          },\n          \"locations\": [\n            {\n              \"physicalLocation\": {\n                \"artifactLocation\": {\n                  \"uri\": \"xx.sarif\"\n                },\n                \"region\": {\n                  \"startLine\": 1,\n                  \"startColumn\": 1,\n                  \"endLine\": 1,\n                  \"endColumn\": 1,\n                  \"byteOffset\": 1,\n                  \"byteLength\": 1\n                }\n              },\n              \"logicalLocations\": [\n                {\n                  \"fullyQualifiedName\": \"dockerfile\"\n                }\n              ]\n            }\n          ],\n          \"suppressions\": [\n            {\n              \"kind\": \"external\"\n            }\n          ],\n          \"baselineState\": \"unchanged\"\n        },\n        {\n          \"ruleId\": \"dep-scan-1\",\n          \"ruleIndex\": 0,\n          \"level\": \"error\",\n          \"message\": {\n            \"text\": \"The path xx.sarif \",\n            \"id\": \"default\"\n          },\n          \"analysisTarget\": {\n            \"uri\": \"xx.sarif\"\n          },\n          \"locations\": [\n            {\n              \"physicalLocation\": {\n                \"artifactLocation\": {\n                  \"uri\": \"xx.sarif\"\n                },\n                \"region\": {\n                  \"startLine\": 1,\n                  \"startColumn\": 1,\n                  \"endLine\": 1,\n                  \"endColumn\": 1,\n                  \"byteOffset\": 1,\n                  \"byteLength\": 1\n                }\n              },\n              \"logicalLocations\": [\n                {\n                  \"fullyQualifiedName\": \"dockerfile\"\n                }\n              ]\n            }\n          ],\n          \"suppressions\": [\n            {\n              \"kind\": \"external\"\n            }\n          ],\n          \"baselineState\": \"unchanged\"\n        }\n      ],\n      \"columnKind\": \"utf16CodeUnits\"\n    }\n  ]\n}"'

#echo  $head | sed 's/} {/}\\n{/g'>1.sarif
echo  $head | sed 's/} {/}\\n{/g'>${licens_sarif_path}
